// concur1.d
// Things to note:
//      writeln is atomic
//      main doesn't kill other threads
//      std.stdio.stdout is a global "shared" (managed) variable

import std.stdio, std.concurrency, std.conv;

void main() {
    int low = 0, high = 100;
    
    // Spawn 4 threads
    foreach (i; 1..5)
        spawn(&fun, i, low, high);
        
    writeln("Main finished");
}

void fun(int tid, int low, int high) {
    foreach (i; low..high)
        writeln("Thread ", tid, ": ", i);    
    writeln("Thread ", tid, " finished");
}

/* Output:
Thread 1: 0
Thread 2: 0
Thread 3: 0
Thread 1: 1
Main finished
Thread 2: 1
Thread 3: 1
Thread 4: 0
Thread 1: 2
Thread 2: 2
Thread 3: 2
Thread 4: 1
Thread 1: 3
Thread 2: 3
Thread 3: 3
Thread 4: 2
Thread 1: 4
Thread 2: 4
Thread 3: 4
Thread 4: 3
Thread 1: 5
Thread 2: 5
Thread 3: 5
Thread 4: 4
Thread 1: 6
Thread 2: 6
Thread 3: 6
Thread 4: 5
Thread 1: 7
Thread 2: 7
Thread 3: 7
Thread 4: 6
Thread 1: 8
Thread 2: 8
Thread 3: 8
Thread 4: 7
Thread 1: 9
Thread 2: 9
Thread 3: 9
Thread 4: 8
Thread 1: 10
Thread 2: 10
Thread 3: 10
Thread 4: 9
Thread 1: 11
Thread 2: 11
Thread 3: 11
Thread 4: 10
Thread 1: 12
Thread 2: 12
Thread 3: 12
Thread 4: 11
Thread 1: 13
Thread 2: 13
Thread 3: 13
Thread 4: 12
Thread 1: 14
Thread 2: 14
Thread 3: 14
Thread 4: 13
Thread 1: 15
Thread 2: 15
Thread 3: 15
Thread 4: 14
Thread 1: 16
Thread 2: 16
Thread 3: 16
Thread 4: 15
Thread 1: 17
Thread 2: 17
Thread 3: 17
Thread 4: 16
Thread 1: 18
Thread 2: 18
Thread 3: 18
Thread 4: 17
Thread 1: 19
Thread 2: 19
Thread 3: 19
Thread 4: 18
Thread 1: 20
Thread 2: 20
Thread 3: 20
Thread 4: 19
Thread 1: 21
Thread 2: 21
Thread 3: 21
Thread 4: 20
Thread 1: 22
Thread 2: 22
Thread 3: 22
Thread 4: 21
Thread 1: 23
Thread 2: 23
Thread 3: 23
Thread 4: 22
Thread 1: 24
Thread 2: 24
Thread 3: 24
Thread 4: 23
Thread 1: 25
Thread 2: 25
Thread 3: 25
Thread 4: 24
Thread 1: 26
Thread 2: 26
Thread 3: 26
Thread 4: 25
Thread 1: 27
Thread 2: 27
Thread 3: 27
Thread 4: 26
Thread 1: 28
Thread 2: 28
Thread 3: 28
Thread 4: 27
Thread 1: 29
Thread 2: 29
Thread 3: 29
Thread 4: 28
Thread 1: 30
Thread 2: 30
Thread 3: 30
Thread 4: 29
Thread 1: 31
Thread 2: 31
Thread 3: 31
Thread 4: 30
Thread 1: 32
Thread 2: 32
Thread 3: 32
Thread 4: 31
Thread 1: 33
Thread 2: 33
Thread 3: 33
Thread 4: 32
Thread 1: 34
Thread 2: 34
Thread 3: 34
Thread 4: 33
Thread 1: 35
Thread 2: 35
Thread 3: 35
Thread 4: 34
Thread 1: 36
Thread 2: 36
Thread 3: 36
Thread 4: 35
Thread 1: 37
Thread 2: 37
Thread 3: 37
Thread 4: 36
Thread 1: 38
Thread 2: 38
Thread 3: 38
Thread 4: 37
Thread 1: 39
Thread 2: 39
Thread 3: 39
Thread 4: 38
Thread 1: 40
Thread 2: 40
Thread 3: 40
Thread 4: 39
Thread 1: 41
Thread 2: 41
Thread 3: 41
Thread 4: 40
Thread 1: 42
Thread 2: 42
Thread 3: 42
Thread 4: 41
Thread 1: 43
Thread 2: 43
Thread 3: 43
Thread 4: 42
Thread 1: 44
Thread 2: 44
Thread 3: 44
Thread 4: 43
Thread 1: 45
Thread 2: 45
Thread 3: 45
Thread 4: 44
Thread 1: 46
Thread 2: 46
Thread 3: 46
Thread 4: 45
Thread 1: 47
Thread 2: 47
Thread 3: 47
Thread 4: 46
Thread 1: 48
Thread 2: 48
Thread 3: 48
Thread 4: 47
Thread 1: 49
Thread 2: 49
Thread 3: 49
Thread 4: 48
Thread 1: 50
Thread 2: 50
Thread 3: 50
Thread 4: 49
Thread 1: 51
Thread 2: 51
Thread 3: 51
Thread 4: 50
Thread 1: 52
Thread 2: 52
Thread 3: 52
Thread 4: 51
Thread 1: 53
Thread 2: 53
Thread 3: 53
Thread 4: 52
Thread 1: 54
Thread 2: 54
Thread 3: 54
Thread 4: 53
Thread 1: 55
Thread 2: 55
Thread 3: 55
Thread 4: 54
Thread 1: 56
Thread 2: 56
Thread 3: 56
Thread 4: 55
Thread 1: 57
Thread 2: 57
Thread 3: 57
Thread 4: 56
Thread 1: 58
Thread 2: 58
Thread 3: 58
Thread 4: 57
Thread 1: 59
Thread 2: 59
Thread 3: 59
Thread 4: 58
Thread 1: 60
Thread 2: 60
Thread 3: 60
Thread 4: 59
Thread 1: 61
Thread 2: 61
Thread 3: 61
Thread 4: 60
Thread 1: 62
Thread 2: 62
Thread 3: 62
Thread 4: 61
Thread 1: 63
Thread 2: 63
Thread 3: 63
Thread 4: 62
Thread 1: 64
Thread 2: 64
Thread 3: 64
Thread 4: 63
Thread 1: 65
Thread 2: 65
Thread 3: 65
Thread 4: 64
Thread 1: 66
Thread 2: 66
Thread 3: 66
Thread 4: 65
Thread 1: 67
Thread 2: 67
Thread 3: 67
Thread 4: 66
Thread 1: 68
Thread 2: 68
Thread 3: 68
Thread 4: 67
Thread 1: 69
Thread 2: 69
Thread 3: 69
Thread 4: 68
Thread 1: 70
Thread 2: 70
Thread 3: 70
Thread 4: 69
Thread 1: 71
Thread 2: 71
Thread 3: 71
Thread 4: 70
Thread 1: 72
Thread 2: 72
Thread 3: 72
Thread 4: 71
Thread 1: 73
Thread 2: 73
Thread 3: 73
Thread 4: 72
Thread 1: 74
Thread 2: 74
Thread 3: 74
Thread 4: 73
Thread 1: 75
Thread 2: 75
Thread 3: 75
Thread 4: 74
Thread 1: 76
Thread 2: 76
Thread 3: 76
Thread 4: 75
Thread 1: 77
Thread 2: 77
Thread 3: 77
Thread 4: 76
Thread 1: 78
Thread 2: 78
Thread 3: 78
Thread 4: 77
Thread 1: 79
Thread 2: 79
Thread 3: 79
Thread 4: 78
Thread 1: 80
Thread 2: 80
Thread 3: 80
Thread 4: 79
Thread 1: 81
Thread 2: 81
Thread 3: 81
Thread 4: 80
Thread 1: 82
Thread 2: 82
Thread 3: 82
Thread 4: 81
Thread 1: 83
Thread 2: 83
Thread 3: 83
Thread 4: 82
Thread 1: 84
Thread 2: 84
Thread 3: 84
Thread 4: 83
Thread 1: 85
Thread 2: 85
Thread 3: 85
Thread 4: 84
Thread 1: 86
Thread 2: 86
Thread 3: 86
Thread 4: 85
Thread 1: 87
Thread 2: 87
Thread 3: 87
Thread 4: 86
Thread 1: 88
Thread 2: 88
Thread 3: 88
Thread 4: 87
Thread 1: 89
Thread 2: 89
Thread 3: 89
Thread 4: 88
Thread 1: 90
Thread 2: 90
Thread 3: 90
Thread 4: 89
Thread 1: 91
Thread 2: 91
Thread 3: 91
Thread 4: 90
Thread 1: 92
Thread 2: 92
Thread 3: 92
Thread 4: 91
Thread 1: 93
Thread 2: 93
Thread 3: 93
Thread 4: 92
Thread 1: 94
Thread 2: 94
Thread 3: 94
Thread 4: 93
Thread 1: 95
Thread 2: 95
Thread 3: 95
Thread 4: 94
Thread 1: 96
Thread 2: 96
Thread 3: 96
Thread 4: 95
Thread 1: 97
Thread 2: 97
Thread 3: 97
Thread 4: 96
Thread 1: 98
Thread 2: 98
Thread 3: 98
Thread 4: 97
Thread 1: 99
Thread 2: 99
Thread 3: 99
Thread 4: 98
Thread 1 finished
Thread 2 finished
Thread 3 finished
Thread 4: 99
Thread 4 finished
*/